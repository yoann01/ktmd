---
layout: post
title: Katana autoMtl - autoSetExpression
tags: [katana, python]
categories:
- blog
---
python code snippets by honeyysharama https://github.com/honeyysharma/Katana

> autoMtlStack.py

Syntax highlighting with Solarized theme.

{% highlight python %}
from Katana import NodegraphAPI
from Katana import KatanaFile
#import json

#can be populated using yaml or json generated by modeling.
partList = ["body","rgt_hand","lft_hand","rgt_leg","lft_leg","head","eyes"]

gsMTL = NodegraphAPI.CreateNode("GroupStack", NodegraphAPI.GetRootNode())

gsMTL.setName("MaterialStack")
gsMTL.setChildNodeType('Material')

childNodeList = []

for part in partList:
    mtlChild = gsMTL.buildChildNode()
    mtlChild.getParameter('name').setValue("MTL_"+part,0)
    childNodeList.append(mtlChild)
{% endhighlight %}

---

> autoSetExpression.py

{% highlight python %}

from Katana import NodegraphAPI
#import json

#can be populated using yaml or json generated by modeling.
partList = ["body","rgt_hand","lft_hand","rgt_leg","lft_leg","head","eyes"]

def createMTLPerPart():

    gsMTL = NodegraphAPI.CreateNode("GroupStack", NodegraphAPI.GetRootNode())
    
    gsMTL.setName("MTL_Stack")
    gsMTL.setChildNodeType('Material')

    mtlNodes = []
    
    for part in partList:
        mtlChild = gsMTL.buildChildNode()
        mtlChild.getParameter('name').setValue("MTL_"+part,0)
        mtlNodes.append(mtlChild)

    return mtlNodes

def createMTLAssignPerPart():

    mtlNodes = createMTLPerPart()

    gsMTLAssign = NodegraphAPI.CreateNode("GroupStack", NodegraphAPI.GetRootNode())
    
    gsMTLAssign.setName("MTL_Assign_Stack")
    gsMTLAssign.setChildNodeType('MaterialAssign')
    
    for i,part in enumerate(partList):
        mtlAssignChild = gsMTLAssign.buildChildNode()
        mtlAssignChild.setName("MTL_Assign_"+part,0)
        mtl = mtlNodes[i]
        mtlAssignChild.getParameter('args.materialAssign.value').setExpression("scenegraphLocationFromNode(getNode('"+mtl.getParameter('name').getValue(0)+"'))")

createMTLAssignPerPart()

{% endhighlight %}
